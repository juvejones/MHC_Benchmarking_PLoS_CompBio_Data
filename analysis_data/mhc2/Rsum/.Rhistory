library(DiagTest3Grp)
setwd("/SFS/user/ctc/zhaoweil/MHC2_IedbNewData_Results/project/Rsum")
###List of alleles and methods
methods = c("NetMHCIIpan", "nn_align", "smm_align", "consensus", "comblib", "tepitope")
allele_list <- read.table("CountLogStrip", sep="")
write("Allele to be calculated:", stderr())
print(allele_list[[1]])
### ANALYSIS ONE  ###
###This segment only used for calculating on summary data of each method
###Generate one summary table and VUS plots for every method
outputfile <- "summary2_3c.txt"
df <- data.frame(methods)
vus_col <- list()
vus_ci_col <- list()
Se_col <- list()
for (i in 1:length(methods)){
method <- methods[i]
file <- paste("../",method,"/Rdata/summary.txt", sep="")
datafile <- read.table(file, col.names=c("peptide","binding_core","meas_nm","meas_bi",
"meas_contin","predict","predict_rank"),sep="\t",
header= FALSE, comment.char="#")
###Set up the input data and classify into three classes
data <- data.frame(datafile)
headerline <- which (with(data,peptide=="peptide"))
data <- data[-headerline,]
Binding <- list()
for (j in 1:length(data$meas_nm)){
if (as.numeric(as.character(data$meas_nm[j]))<50){
Binding[j]="SB"
}
else if (as.numeric(as.character(data$meas_nm[j]))<500){
Binding[j]="WB"
}
else {
Binding[j]="NB"
}
}
data$binding <- Binding
group <- data$binding
## Three of the methods use RANK as affinity meas and should be taken care of
if (method == "consensus" || method == "comblib" || method == "tepitope"){
factor <- 1-as.numeric(as.character(data$predict_rank))
}
else {
factor <- as.numeric(as.character(data$predict))
}
x <- factor[group=="NB"]
y <- factor[group=="WB"]
z <- factor[group=="SB"]
###Calculate VUS, VUS_CI and Se
vus <- VUS(x,y,z,method="Normal",p=0,q=0,alpha=0.05)
vus_col[i] <- vus$estimate
vus_ci_col[i] <- (vus$estimate - vus$CI[1])
## Use predicted binding affinity as threshold
Se_col[i] <- Sp.Sm.Se(x,y,z,0.426,0.638)[3]
###Plot the data generated by VUS; only needed for summary data
pdf(paste(method,"_3c_eval.pdf"),width=8,height=4)
plot(vus)
dev.off()
}
data <- read.table("MHC2_benchmark.txt",header=T)
data
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = AUC,ymin = (AUC-AUC...), ymax = (AUC+AUC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=16), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0,0.75)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = AUC,ymin = (AUC-AUC...), ymax = (AUC+AUC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
#p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=16), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0,0.75)
data$AUC
data$AUC...
data$Method
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = AUC,ymin = (AUC-AUC...), ymax = (AUC+AUC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=16), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.4,1)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = AUC,ymin = (AUC-AUC...), ymax = (AUC+AUC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=16), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.6,1)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = AUC,ymin = (AUC-AUC...), ymax = (AUC+AUC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=16), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.7,0.95)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = AUC,ymin = (AUC-AUC...), ymax = (AUC+AUC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.7,0.95)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = SRCC,ymin = (SRCC-SRCC...), ymax = (SRCC+SRCC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.7,0.95)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = SRCC,ymin = (SRCC-SRCC...), ymax = (SRCC+SRCC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.65,0.85)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = SRCC,ymin = (SRCC-SRCC...), ymax = (SRCC+SRCC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.55,0.85)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = SRCC,ymin = (SRCC-SRCC...), ymax = (SRCC+SRCC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.45,0.85)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.45,0.9)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = SRCC,ymin = (SRCC-SRCC...), ymax = (SRCC+SRCC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.45,0.9)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = VUC,ymin = (VUC-VUC...), ymax = (VUC+VUC...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.45,0.9)
data
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.45,0.9)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
#p <- p + geom_bar(aes(weight = R2),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.3,0.7)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
p <- ggplot(data,aes(Method,Se,fill=Method))
#p <- ggplot(data,aes(Method,fill=Method))
#p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
p <- p + geom_bar(aes(weight = Se),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.3,0.7)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
#p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
p <- p + geom_bar(aes(weight = Se),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0.3,0.7)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
#p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
p <- p + geom_bar(aes(weight = Se),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0,0.7)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
#p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
p <- p + geom_bar(aes(weight = Se),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0,0.6)
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
#p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
p <- p + geom_bar(aes(weight = Se),width = 0.5)
p + scale_fill_brewer(palette="Set1")
+ theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16))
+ ylim(0,0.6)
+ ylab("Specificity")
library(RColorBrewer)
library(ggplot2)
data <- data.frame(data)
#p <- ggplot(data,aes(Method,Se,fill=Method))
p <- ggplot(data,aes(Method,fill=Method))
#p <- p + geom_crossbar(aes(y = VUS,ymin = (VUS-VUS...), ymax = (VUS+VUS...)), width = 0.5)
p <- p + geom_bar(aes(weight = Se),width = 0.5)
p + scale_fill_brewer(palette="Set1") + theme(legend.text=element_text(size=18), axis.title=element_text(size=18), axis.text.x = element_blank(), axis.text.y = element_text(size=16)) + ylim(0,0.6)+ ylab("Specificity")
